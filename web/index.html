<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="my.css">
    <script src="https://code.jquery.com/jquery-latest.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/4.3.7/mqtt.min.js"
            integrity="sha512-tc5xpAPaQDl/Uxd7ZVbV66v94Lys0IefMJSdlABPuzyCv0IXmr9TkqEQvZiWKRoXMSlP5YPRwpq2a+v5q2uzMg=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        function callFunction(obj) {
            $(".active").removeClass("active");
            $(obj).addClass("active");
        }
        $(function () {
            const client = mqtt.connect("ws://127.0.0.1:9001");
            client.subscribe("#");

            client.on("message", function (topic, payload) {
                let message = payload.toString();
                console.log(topic)
                $("#paragraph").append(`<span class=${topic}>${message}</span><br>`);
                if ($(`#sidebar #${topic}`).length === 0) {
                    $("#sidebar").append(`<li><a id=${topic} href="javascript:void(0);" onclick="callFunction(this);">${topic}</a></li>`);
                }

                if ($(`#${topic}`).hasClass("active")) {
                    $(`.${topic}`).show();
                } else {
                    $(`.${topic}`).hide();
                }
            });
        })
    </script>
</head>
<body>
<ul id="sidebar">
    <li><a class="active" href="#home">Home</a></li>
</ul>
<div style="margin-left:10%;padding:1px 16px;">
    height:1000px;
    <p id="paragraph"></p>
</div>
</body>
</html>